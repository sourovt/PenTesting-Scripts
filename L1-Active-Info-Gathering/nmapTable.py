#!/usr/bin/env python

# This program will parse NMAP xml output to display ports and versions of target

import subprocess
import xml.etree.ElementTree as ET

ipAddr = "10.0.2.5"

nmapXML = subprocess.check_output(["nmap", "-sV", ipAddr, "-oX", "-"])

root = ET.fromstring(nmapXML)

print '---------------------------------------------------------'

for port in root.iter('port'):
    service = port.find('service')
    product = service.get('product')
    version = service.get('version')
    print '| Port:', port.get('portid'), '|| Service:', product, ' || Version:', version, '|'
    print '--------------------------------------------------------'
